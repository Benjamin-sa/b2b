name = "b2b-inventory-service"
main = "src/index.ts"
compatibility_date = "2024-11-01"

# ============================================================================
# PRODUCTION (DEFAULT - No --env flag)
# ============================================================================
[[d1_databases]]
binding = "DB"
database_name = "b2b-prod"
database_id = "7cc12490-bd4c-42dc-a3eb-1dc290a864a0"

# Service binding for auth validation (no HTTP overhead!)
[[services]]
binding = "AUTH_SERVICE"
service = "b2b-auth-service"

# Service binding for Stripe operations
[[services]]
binding = "STRIPE_SERVICE"
service = "b2b-stripe-service"

[vars]
ENVIRONMENT = "production"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:4173,https://4tparts.com"
DEFAULT_PAGE_SIZE = "20"
MAX_PAGE_SIZE = "100"

# ============================================================================
# DEVELOPMENT ENVIRONMENT
# ============================================================================
[env.dev]
name = "b2b-inventory-service-dev"

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true

[[env.dev.d1_databases]]
binding = "DB"
database_name = "b2b-dev"
database_id = "0420eb79-c871-4fdb-bbf3-6deb62d5c0c3"

# Service binding for dev environment
[[env.dev.services]]
binding = "AUTH_SERVICE"
service = "b2b-auth-service-dev"

[[env.dev.services]]
binding = "STRIPE_SERVICE"
service = "b2b-stripe-service-dev"

[env.dev.vars]
ENVIRONMENT = "development"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:4173,http://localhost:5174"
DEFAULT_PAGE_SIZE = "20"
MAX_PAGE_SIZE = "100"

# No secrets needed - services authenticate via auth-service
