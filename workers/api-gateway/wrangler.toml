name = "b2b-api-gateway"
main = "src/index.ts"
compatibility_date = "2024-11-01"

# ============================================================================
# SERVICE BINDINGS (Production - No --env flag)
# ============================================================================
# Service bindings allow direct worker-to-worker communication
# without HTTP overhead. Much faster than fetch()!

[[services]]
binding = "AUTH_SERVICE"
service = "b2b-auth-service"

[[services]]
binding = "EMAIL_SERVICE"
service = "b2b-email-service"

[[services]]
binding = "INVENTORY_SERVICE"
service = "b2b-inventory-service"

# Production vars (used when no --env specified)
[vars]
ENVIRONMENT = "production"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:4173,https://4tparts.com"

# ============================================================================
# DEVELOPMENT ENVIRONMENT
# ============================================================================
[env.dev]
name = "b2b-api-gateway-dev"

[[env.dev.services]]
binding = "AUTH_SERVICE"
service = "b2b-auth-service-dev"

[[env.dev.services]]
binding = "EMAIL_SERVICE"
service = "b2b-email-service-dev"

[[env.dev.services]]
binding = "INVENTORY_SERVICE"
service = "b2b-inventory-service-dev"

[env.dev.vars]
ENVIRONMENT = "development"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:4173"
